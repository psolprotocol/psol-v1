# =============================================================================
# pSol Relayer Configuration - Mainnet Ready
# =============================================================================
# Copy this file to .env and fill in the values
# SECURITY: Never commit .env to version control!

# =============================================================================
# SOLANA CONNECTION
# =============================================================================

# RPC endpoint URL (required)
# For mainnet, use a paid RPC provider (Helius, QuickNode, Alchemy)
SOLANA_RPC_URL=https://api.devnet.solana.com

# WebSocket URL (optional - derived from RPC URL if not set)
# SOLANA_WS_URL=wss://api.devnet.solana.com

# Network identifier
# Options: devnet, testnet, mainnet-beta
SOLANA_NETWORK=devnet

# Commitment level for transactions
# Options: processed, confirmed, finalized
# Use 'confirmed' for most cases, 'finalized' for highest security
SOLANA_COMMITMENT=confirmed

# =============================================================================
# PSOL PROGRAM
# =============================================================================

# pSol program ID (required)
# Devnet: DRDywerR6UCmvGCTTDf6aDefj7rLBKBQEp44DHrMeWkF
PSOL_PROGRAM_ID=DRDywerR6UCmvGCTTDf6aDefj7rLBKBQEp44DHrMeWkF

# Path to verification key JSON file (for local proof validation)
VERIFICATION_KEY_PATH=./keys/verification_key.json

# =============================================================================
# RELAYER WALLET - SECURITY CRITICAL
# =============================================================================

# Base58-encoded private key of the relayer wallet (required)
# SECURITY: Use a dedicated hot wallet with limited funds
# SECURITY: In production, consider using a secrets manager
# Generate with: solana-keygen new --no-bip39-passphrase
RELAYER_PRIVATE_KEY=

# Balance thresholds (in SOL)
# Alerts when balance drops below MIN_BALANCE
RELAYER_MAX_BALANCE=10
RELAYER_MIN_BALANCE=0.5

# =============================================================================
# FEE CONFIGURATION
# =============================================================================

# Base relayer fee in basis points (1 BPS = 0.01%)
# Example: 50 = 0.5% fee
BASE_FEE_BPS=50

# Minimum fee in lamports (regardless of percentage)
MIN_FEE_LAMPORTS=10000

# Maximum fee cap in basis points
MAX_FEE_BPS=500

# Enable dynamic fees based on network congestion
ENABLE_DYNAMIC_FEES=true

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

# API server port
PORT=3000

# Bind address (0.0.0.0 for all interfaces)
HOST=0.0.0.0

# CORS allowed origins (comma-separated, or * for all)
# Production: Set to your frontend domain(s)
CORS_ORIGINS=*

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis connection for job queue and rate limiting
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# =============================================================================
# RATE LIMITING
# =============================================================================

# Global rate limit window (milliseconds)
RATE_LIMIT_WINDOW_MS=60000

# Maximum requests per window per IP
RATE_LIMIT_MAX_REQUESTS=60

# Maximum pending jobs per IP address
MAX_PENDING_PER_IP=5

# Maximum total pending jobs (queue capacity)
MAX_PENDING_GLOBAL=1000

# =============================================================================
# AUTHENTICATION
# =============================================================================

# API keys for write access (comma-separated)
# Each key must be at least 32 characters
# Generate with: openssl rand -hex 32
# Example: RELAYER_API_KEYS=abc123...,def456...
RELAYER_API_KEYS=

# Admin API key for management endpoints
# Generate with: openssl rand -hex 32
ADMIN_API_KEY=

# IP allowlist (comma-separated, empty = all IPs allowed)
# Supports exact IPs and /24 CIDR notation
# Example: ALLOWED_IPS=1.2.3.4,10.0.0.0/24
ALLOWED_IPS=

# Require API key for write endpoints (POST /withdraw, etc.)
# Set to true for mainnet!
REQUIRE_AUTH_FOR_WRITE=false

# Allow unauthenticated read access (GET /health, /info, etc.)
ALLOW_UNAUTHENTICATED_READ=true

# =============================================================================
# OBSERVABILITY
# =============================================================================

# Log level
# Options: trace, debug, info, warn, error, fatal
LOG_LEVEL=info

# Enable metrics endpoint
ENABLE_METRICS=true

# Metrics endpoint path
METRICS_PATH=/metrics

# =============================================================================
# ENVIRONMENT
# =============================================================================

# Node environment
# Options: development, test, production
# SECURITY: Set to 'production' for mainnet
NODE_ENV=development
