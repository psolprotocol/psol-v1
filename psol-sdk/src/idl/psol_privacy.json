{
  "address": "7kK3aVXN9nTv1dNubmr85FB85fK6PeRrDBsisu9Z4gQ9",
  "metadata": {
    "name": "psol_privacy",
    "version": "1.0.0",
    "spec": "0.1.0",
    "description": "pSol Privacy Pool - Zero-knowledge privacy pool for Solana"
  },
  "instructions": [
    {
      "name": "initialize_pool",
      "discriminator": [48, 191, 163, 44, 71, 129, 63, 164],
      "accounts": [
        { "name": "authority", "writable": true, "signer": true },
        { "name": "token_mint", "writable": false },
        { "name": "pool_config", "writable": true, "pda": { "seeds": [{ "kind": "const", "value": "pool" }, { "kind": "account", "path": "token_mint" }] } },
        { "name": "merkle_tree", "writable": true, "pda": { "seeds": [{ "kind": "const", "value": "merkle_tree" }, { "kind": "account", "path": "pool_config" }] } },
        { "name": "verification_key", "writable": true, "pda": { "seeds": [{ "kind": "const", "value": "verification_key" }, { "kind": "account", "path": "pool_config" }] } },
        { "name": "vault", "writable": true, "pda": { "seeds": [{ "kind": "const", "value": "vault" }, { "kind": "account", "path": "pool_config" }] } },
        { "name": "token_program" },
        { "name": "system_program" }
      ],
      "args": [
        { "name": "tree_depth", "type": "u8" },
        { "name": "root_history_size", "type": "u16" }
      ]
    },
    {
      "name": "set_verification_key",
      "discriminator": [159, 173, 116, 82, 64, 127, 145, 233],
      "accounts": [
        { "name": "authority", "writable": false, "signer": true },
        { "name": "pool_config", "writable": true },
        { "name": "verification_key", "writable": true }
      ],
      "args": [
        { "name": "vk_alpha_g1", "type": { "array": ["u8", 64] } },
        { "name": "vk_beta_g2", "type": { "array": ["u8", 128] } },
        { "name": "vk_gamma_g2", "type": { "array": ["u8", 128] } },
        { "name": "vk_delta_g2", "type": { "array": ["u8", 128] } },
        { "name": "vk_ic", "type": { "vec": { "array": ["u8", 64] } } }
      ]
    },
    {
      "name": "lock_verification_key",
      "discriminator": [234, 122, 87, 159, 45, 12, 33, 78],
      "accounts": [
        { "name": "authority", "writable": false, "signer": true },
        { "name": "pool_config", "writable": true },
        { "name": "verification_key", "writable": true }
      ],
      "args": []
    },
    {
      "name": "deposit",
      "discriminator": [242, 35, 198, 137, 82, 225, 242, 182],
      "accounts": [
        { "name": "pool_config", "writable": true },
        { "name": "merkle_tree", "writable": true },
        { "name": "vault", "writable": true },
        { "name": "depositor_token_account", "writable": true },
        { "name": "depositor", "writable": true, "signer": true },
        { "name": "token_program" }
      ],
      "args": [
        { "name": "amount", "type": "u64" },
        { "name": "commitment", "type": { "array": ["u8", 32] } }
      ]
    },
    {
      "name": "withdraw",
      "discriminator": [183, 18, 70, 156, 148, 109, 161, 34],
      "accounts": [
        { "name": "pool_config", "writable": true },
        { "name": "merkle_tree", "writable": false },
        { "name": "verification_key", "writable": false },
        { "name": "spent_nullifier", "writable": true },
        { "name": "vault", "writable": true },
        { "name": "recipient_token_account", "writable": true },
        { "name": "relayer_token_account", "writable": true },
        { "name": "payer", "writable": true, "signer": true },
        { "name": "token_program" },
        { "name": "system_program" }
      ],
      "args": [
        { "name": "proof_data", "type": "bytes" },
        { "name": "merkle_root", "type": { "array": ["u8", 32] } },
        { "name": "nullifier_hash", "type": { "array": ["u8", 32] } },
        { "name": "recipient", "type": "pubkey" },
        { "name": "amount", "type": "u64" },
        { "name": "relayer", "type": "pubkey" },
        { "name": "relayer_fee", "type": "u64" }
      ]
    },
    {
      "name": "pause_pool",
      "discriminator": [77, 55, 99, 112, 78, 55, 66, 101],
      "accounts": [
        { "name": "authority", "writable": false, "signer": true },
        { "name": "pool_config", "writable": true }
      ],
      "args": []
    },
    {
      "name": "unpause_pool",
      "discriminator": [88, 45, 101, 115, 65, 77, 98, 111],
      "accounts": [
        { "name": "authority", "writable": false, "signer": true },
        { "name": "pool_config", "writable": true }
      ],
      "args": []
    },
    {
      "name": "initiate_authority_transfer",
      "discriminator": [112, 78, 99, 55, 77, 101, 88, 45],
      "accounts": [
        { "name": "authority", "writable": false, "signer": true },
        { "name": "pool_config", "writable": true }
      ],
      "args": [
        { "name": "new_authority", "type": "pubkey" }
      ]
    },
    {
      "name": "accept_authority_transfer",
      "discriminator": [55, 77, 101, 88, 45, 112, 78, 99],
      "accounts": [
        { "name": "new_authority", "writable": false, "signer": true },
        { "name": "pool_config", "writable": true }
      ],
      "args": []
    },
    {
      "name": "cancel_authority_transfer",
      "discriminator": [101, 88, 45, 112, 78, 99, 55, 77],
      "accounts": [
        { "name": "authority", "writable": false, "signer": true },
        { "name": "pool_config", "writable": true }
      ],
      "args": []
    }
  ],
  "accounts": [
    {
      "name": "PoolConfig",
      "discriminator": [26, 108, 14, 123, 116, 230, 129, 43]
    },
    {
      "name": "MerkleTree",
      "discriminator": [99, 43, 98, 78, 156, 32, 78, 112]
    },
    {
      "name": "VerificationKeyAccount",
      "discriminator": [78, 45, 89, 123, 77, 99, 88, 56]
    },
    {
      "name": "SpentNullifier",
      "discriminator": [156, 78, 112, 99, 43, 98, 78, 156]
    }
  ],
  "events": [
    {
      "name": "DepositEvent",
      "discriminator": [200, 156, 78, 112, 99, 43, 98, 78]
    },
    {
      "name": "WithdrawEvent",
      "discriminator": [201, 156, 78, 112, 99, 43, 98, 78]
    }
  ],
  "errors": [
    { "code": 6000, "name": "InvalidProof", "msg": "Invalid proof: verification failed" },
    { "code": 6001, "name": "InvalidProofFormat", "msg": "Invalid proof format: expected 256 bytes" },
    { "code": 6002, "name": "InvalidPublicInputs", "msg": "Invalid public inputs for proof verification" },
    { "code": 6003, "name": "VerificationKeyNotSet", "msg": "Verification key not configured for this pool" },
    { "code": 6004, "name": "InvalidMerkleRoot", "msg": "Merkle root not in recent history" },
    { "code": 6005, "name": "MerkleTreeFull", "msg": "Merkle tree is full" },
    { "code": 6006, "name": "InvalidTreeDepth", "msg": "Tree depth must be between 4 and 24" },
    { "code": 6007, "name": "InvalidRootHistorySize", "msg": "Root history size must be at least 30" },
    { "code": 6008, "name": "NullifierAlreadySpent", "msg": "Nullifier already spent" },
    { "code": 6009, "name": "InvalidNullifier", "msg": "Invalid nullifier: cannot be all zeros" },
    { "code": 6010, "name": "InvalidAmount", "msg": "Invalid amount: must be greater than zero" },
    { "code": 6011, "name": "InsufficientBalance", "msg": "Insufficient vault balance" },
    { "code": 6012, "name": "InvalidMint", "msg": "Token mint does not match pool configuration" },
    { "code": 6013, "name": "RelayerFeeExceedsAmount", "msg": "Relayer fee exceeds withdrawal amount" },
    { "code": 6014, "name": "InvalidCommitment", "msg": "Invalid commitment: cannot be all zeros" },
    { "code": 6017, "name": "Unauthorized", "msg": "Unauthorized: caller is not pool authority" },
    { "code": 6018, "name": "PoolPaused", "msg": "Pool is paused" },
    { "code": 6019, "name": "RecipientMismatch", "msg": "Recipient does not match proof public inputs" },
    { "code": 6020, "name": "ArithmeticOverflow", "msg": "Arithmetic overflow" },
    { "code": 6023, "name": "VerificationKeyLocked", "msg": "Verification key is locked and cannot be modified" },
    { "code": 6024, "name": "InvalidAuthority", "msg": "Invalid authority address" },
    { "code": 6025, "name": "NoPendingAuthority", "msg": "No pending authority transfer" }
  ],
  "types": [
    {
      "name": "PoolConfig",
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "authority", "type": "pubkey" },
          { "name": "pending_authority", "type": "pubkey" },
          { "name": "token_mint", "type": "pubkey" },
          { "name": "vault", "type": "pubkey" },
          { "name": "merkle_tree", "type": "pubkey" },
          { "name": "verification_key", "type": "pubkey" },
          { "name": "tree_depth", "type": "u8" },
          { "name": "bump", "type": "u8" },
          { "name": "is_paused", "type": "bool" },
          { "name": "vk_configured", "type": "bool" },
          { "name": "vk_locked", "type": "bool" },
          { "name": "total_deposits", "type": "u64" },
          { "name": "total_withdrawals", "type": "u64" },
          { "name": "total_value_deposited", "type": "u64" },
          { "name": "total_value_withdrawn", "type": "u64" },
          { "name": "version", "type": "u8" }
        ]
      }
    },
    {
      "name": "MerkleTree",
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "pool", "type": "pubkey" },
          { "name": "depth", "type": "u8" },
          { "name": "next_leaf_index", "type": "u32" },
          { "name": "current_root", "type": { "array": ["u8", 32] } },
          { "name": "root_history", "type": { "vec": { "array": ["u8", 32] } } },
          { "name": "root_history_index", "type": "u16" },
          { "name": "root_history_size", "type": "u16" },
          { "name": "filled_subtrees", "type": { "vec": { "array": ["u8", 32] } } },
          { "name": "zeros", "type": { "vec": { "array": ["u8", 32] } } }
        ]
      }
    },
    {
      "name": "VerificationKeyAccount",
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "pool", "type": "pubkey" },
          { "name": "is_initialized", "type": "bool" },
          { "name": "bump", "type": "u8" },
          { "name": "alpha_g1", "type": { "array": ["u8", 64] } },
          { "name": "beta_g2", "type": { "array": ["u8", 128] } },
          { "name": "gamma_g2", "type": { "array": ["u8", 128] } },
          { "name": "delta_g2", "type": { "array": ["u8", 128] } },
          { "name": "ic", "type": { "vec": { "array": ["u8", 64] } } }
        ]
      }
    },
    {
      "name": "SpentNullifier",
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "pool", "type": "pubkey" },
          { "name": "nullifier_hash", "type": { "array": ["u8", 32] } },
          { "name": "spent_at", "type": "i64" },
          { "name": "spent_slot", "type": "u64" },
          { "name": "bump", "type": "u8" }
        ]
      }
    },
    {
      "name": "DepositEvent",
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "pool", "type": "pubkey" },
          { "name": "commitment", "type": { "array": ["u8", 32] } },
          { "name": "leaf_index", "type": "u32" },
          { "name": "amount", "type": "u64" },
          { "name": "timestamp", "type": "i64" }
        ]
      }
    },
    {
      "name": "WithdrawEvent",
      "type": {
        "kind": "struct",
        "fields": [
          { "name": "pool", "type": "pubkey" },
          { "name": "nullifier_hash", "type": { "array": ["u8", 32] } },
          { "name": "recipient", "type": "pubkey" },
          { "name": "amount", "type": "u64" },
          { "name": "relayer", "type": "pubkey" },
          { "name": "relayer_fee", "type": "u64" },
          { "name": "timestamp", "type": "i64" }
        ]
      }
    }
  ]
}
